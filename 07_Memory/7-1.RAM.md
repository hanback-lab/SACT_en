# RAM
---

- **RAM**

All random access memory consists of a certain number of words in memory, where a word is a set of bits.

For example, if one RAM consists of a total of 1024 words, the address of the first word is 0 in decimal. Address of the last word is 1023. This means 0000000000(0) ~ 1111111111(1023) in binary, and 10 address lines are required to access all the words. 10-bit address of this address line indicates which location in RAM to access.



<img src="./pds/mem02.png" alt="p03" style="width: 70%;">

<br>

Assuming that each word in RAM is n bits, this means that the length of a word is n bits. In other words, n data lines are required.

If RAM consists of 2^k words, k address lines are required to access this word. Similarly, writing data in word requires n input lines.

Instead of having separate data lines for reading and writing on memory, the same line is used for reading and writing. Therefore, it is determined whether data is written on RAM or data is read from memory by read and write control signal.


<img src="./pds/mem03.png" alt="p03" style="width: 70%;">

<br>

Read and write signals determine in which direction data moves in memory. 

Reading or writing data in RAM requires a control signal, a specific number of address, and input of data in a specific order.


<img src="./pds/mem04.png" alt="p03" style="width: 70%;">

<br>

In the case of RAM commonly used, read and write control signals can be controlled by one single control signal rather than two separate control signals as shown above.

The above memory is controlled as below.


|Enable |Read/Write|Operation|
|:-:|:-:|:-:|
|0|X|None|
|1|0| Data write |
|1|1| Data read|

Read 동작

<img src="./pds/mem05.png" alt="p03" style="width: 50%;">

<br>


Write 동작

<img src="./pds/mem06.png" alt="p03" style="width: 50%;">

<br>




---
## **Practice Objectives **

Let's design and experiment with the circuit below.

<br>

<img src="./pds/ram01.png" alt="p03" style="width: 100%;">

<br>

This circuit is RAM that can store 4-bit data line and 32 data (Address 5 bits). 

It is a block that uses FPGA internal RAM and appearance and operation of circuit are different from that described before.

The differences are as below.

- There are DATA line for both input and output (Also called Dual Port RAM)

- Write operation is performed when WR signal is 1 and at the rising edge of the clock

- Read operation is performed when WR signal is 0 and at the rising edge of the clock
 


<br>

Devices connected to check in SACT equipment are as below.

|WR|CLK|ADDR[4]|ADDR[3]|ADDR[2]|ADDR[1]|ADDR[0]|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|S7|SW3|S4|S3|S2|S1|S0|

|DIN[3]|DIN[2]|DIN[1]|DIN[0]|Q[3]|Q[2]|Q[1]|Q[0]|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|SW7|SW6|SW5|SW4|LED7|LED6|LED5|LED4|

<br>

<img src="./pds/sact-ram.png" alt="smot-mo" style="width: 60%;">

<br>


### **Design**

1. 실험을 위해 프로젝트 파일 <a href="./pds/SACT_RAM.zip" download>SACT_RAM.zip</a>을 준비한다. 
<br>

2. 다운로드된 프로젝트의 압축 파일을 d:\work 이동시킨 후, 압축을 푼다.

3. Quartus II를 실행키고, File> Open Project 메뉴를 선택한다. 

<br>

4. 위에서 압축을 푼 위치인, d:\work\SACT_RAM 폴더로 이동 후,SACT_RAM 프로젝트를 OPEN한다. 

<br>

5. File > Open 메뉴를 선택하여 SACT_RAM.bdf 파일을 불러오거나, 프로젝트 왼쪽의 SACT_RAM 부분을 마우스로 더블 클릭한다. 

<br>

6. 아래 그림과 같이 미완성된 도면이 보이는데, Practice Objectives에서 설명한 도면으로 완성시키자. 

<img src="./pds/ram03.png" alt="p05" style="width: 80%;"><br>


7. S_RAM 심볼을 불러오고, wire로 심볼을 연결시켜 회로를 완성시킨다.  

<img src="./pds/ram02.png" alt="p08" style="width: 100%;"><br>

<br>


### **Compile**


8. File > Save 메뉴를 선택하여 저장하고, Processing > Start Compilation 메뉴를 선택하여 Compile을 진행한다. 

이 Compile 과정은 Design한 논리 회로에 오류가 없는 지를 검증하고, 프로그래밍 파일과 Simulation 파일을 만드는 과정이다. 

<br><br>


### **Simulation**

9. Compile 완료 후, File > Open 메뉴를 선택하고, 나타나는 Open File 창에서 오른쪽 아래 부분의 File Type을 All File(*.*)로 변경한 후, Waveform.vwf 파일을 선택한다. 

10. 아래 그림과 같이 Waveform 창에서, Simulation > Run Functiona Simulation 메뉴를 선택하여 Functional Simulation을 진행하여, 결과를 확인한다. 

<img src="./pds/ex10.png" alt="p11" style="width: 70%;"><br>

<img src="./pds/ram05.png" alt="p10" style="width: 100%;"><br>
<br>

### **Check Hardware Operation**

11. SACT 장비를 준비한다. USB 케이블과 파워 케이블을 연결하고, 전원 스위치를 눌러 장비에 전원을 인가시킨다. 

12. Quartus 소프트웨어에서 Tool > Programmer 메뉴를 선택한다.

13. Programmer창의 Hardware Setup이 USB Blaster가 연결되어 있는지 확인하고, Start 버튼을 눌러 프로그래밍 하고 장비에서 동작을 확인한다. 

<br>

14. 아래와 같이 실험을 해보자. 

    - Slide Switch(S4-S0)를 이용해 ADDR[4..0]을 설정한다. 
    - WRITE를 위해 WR(S7)을 1로 놓는다. 
    - DIN[3..0]을 위하여 SW7-SW4에 임의의 데이터를 설정하고, CLK(SW3)을 입력한다. 
    - READ를 위해 WR(S7)을 0으로 놓는다. 
    - CLK를 입력한다. (ADDR[4..0]을 바꾸지 않으면 입력되었던 값이 출력됨.)

    - WR을 1로 설정하고 ADDR과 DATA를 바꾸어가며 입력한다. 
    - WR을 0으로 하고, ADDR을 설정한 후, CLK를 눌러 입력된 값이 출력되는지 확인한다. 


|WR|CLK|ADDR[4]|ADDR[3]|ADDR[2]|ADDR[1]|ADDR[0]|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|S7|SW3|S4|S3|S2|S1|S0|

|DIN[3]|DIN[2]|DIN[1]|DIN[0]|Q[3]|Q[2]|Q[1]|Q[0]|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|SW7|SW6|SW5|SW4|LED7|LED6|LED5|LED4|

<br>

<img src="./pds/sact-ram.png" alt="smot-mo" style="width: 60%;">


<br>