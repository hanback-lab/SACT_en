# RAM
---

- **RAM**

All random access memory consists of a certain number of words in memory, where a word is a set of bits.

For example, if one RAM consists of a total of 1024 words, the address of the first word is 0 in decimal. Address of the last word is 1023. This means 0000000000(0) ~ 1111111111(1023) in binary, and 10 address lines are required to access all the words. 10-bit address of this address line indicates which location in RAM to access.



<img src="./pds/mem02.png" alt="p03" style="width: 70%;">

<br>

Assuming that each word in RAM is n bits, this means that the length of a word is n bits. In other words, n data lines are required.

If RAM consists of 2^k words, k address lines are required to access this word. Similarly, writing data in word requires n input lines.

Instead of having separate data lines for reading and writing on memory, the same line is used for reading and writing. Therefore, it is determined whether data is written on RAM or data is read from memory by read and write control signal.


<img src="./pds/mem03.png" alt="p03" style="width: 70%;">

<br>

Read and write signals determine in which direction data moves in memory. 

Reading or writing data in RAM requires a control signal, a specific number of address, and input of data in a specific order.


<img src="./pds/mem04.png" alt="p03" style="width: 70%;">

<br>

In the case of RAM commonly used, read and write control signals can be controlled by one single control signal rather than two separate control signals as shown above.

The above memory is controlled as below.


|Enable |Read/Write|Operation|
|:-:|:-:|:-:|
|0|X|None|
|1|0| Data write |
|1|1| Data read|

Read 동작

<img src="./pds/mem05.png" alt="p03" style="width: 50%;">

<br>


Write 동작

<img src="./pds/mem06.png" alt="p03" style="width: 50%;">

<br>




---
## **Practice Objectives **

Let's design and experiment with the circuit below.

<br>

<img src="./pds/ram01.png" alt="p03" style="width: 100%;">

<br>

This circuit is RAM that can store 4-bit data line and 32 data (Address 5 bits). 

It is a block that uses FPGA internal RAM and appearance and operation of circuit are different from that described before.

The differences are as below.

- There are DATA line for both input and output (Also called Dual Port RAM)

- Write operation is performed when WR signal is 1 and at the rising edge of the clock

- Read operation is performed when WR signal is 0 and at the rising edge of the clock
 


<br>

Devices connected to check in SACT equipment are as below.

|WR|CLK|ADDR[4]|ADDR[3]|ADDR[2]|ADDR[1]|ADDR[0]|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|S7|SW3|S4|S3|S2|S1|S0|

|DIN[3]|DIN[2]|DIN[1]|DIN[0]|Q[3]|Q[2]|Q[1]|Q[0]|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|SW7|SW6|SW5|SW4|LED7|LED6|LED5|LED4|

<br>

<img src="./pds/sact-ram.png" alt="smot-mo" style="width: 60%;">

<br>


### **Design**

1. Prepare project file <a href="./pds/SACT_RAM.zip" download>SACT_RAM.zip</a> for the experiment.
<br>

2. Move the project compressed file downloaded to d:＼work and unzip it.

3. Run Quartus II and select File > Open Project.`

<br>

4. Go to d:＼work＼SACT_RAM folder, where the files are unzipped, and open SACT_RAM project.

<br>

5. Select File > Open to import SACT_RAM.bdf file. Or double-click SACT_RAM on the left side of the project.

<br>

6. Unfinished drawing is shown. Let's complete it with the drawing described before.  

<img src="./pds/ram03.png" alt="p05" style="width: 80%;"><br>


7. Complete the circuit by importing “S_RAM” symbol and connecting it with wire.

<img src="./pds/ram02.png" alt="p08" style="width: 100%;"><br>

<br>


### **Compile**


8. Select File > Save and save, and select Processing > Start Compilation to compile.

    Compilation is process to verify that there are no errors in the designed logic circuit and create programming file and simulation file.


<br><br>


### **Simulation**

9. Select File > Open, and change File Type to All Files (.) in Open File window in the lower right corner, then select Waveform.vwf file.

10. In Waveform window, select Simulation > Run Functional Simulation to run it.
 

<img src="./pds/ex10.png" alt="p11" style="width: 70%;"><br>

<img src="./pds/ram05.png" alt="p10" style="width: 100%;"><br>
<br>

### **Check Hardware Operation**

11. Prepare SACT equipment. Connect USB cable and power cable and press the power switch to supply power to the device.

12. In Quartus software, select Tool > Programmer.

13. Check that USB Blaster is connected in Hardware Setup on Programmer window. Press Start button to program to check the operation on the device.

14. Let’s perform an experiment as below.

    - Set ADDR[4..0] using Slide Switch (S4~S0).
    - Set WR(S7) to 1 for WRITE.
    - Set arbitrary data to SW7~SW4 for DIN[3..0] and enter CLK(SW3).
    - Set WR(S7) to 0 for READ.
    - Enter CLK (If not changing ADDR[4..0], entered value is output).
    - Set WR to 1 and enter ADDR and DATA alternately.
    - Set WR to 0, set ADDR, and press CLK to check if the entered value is output.



|WR|CLK|ADDR[4]|ADDR[3]|ADDR[2]|ADDR[1]|ADDR[0]|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|S7|SW3|S4|S3|S2|S1|S0|

|DIN[3]|DIN[2]|DIN[1]|DIN[0]|Q[3]|Q[2]|Q[1]|Q[0]|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|SW7|SW6|SW5|SW4|LED7|LED6|LED5|LED4|

<br>

<img src="./pds/sact-ram.png" alt="smot-mo" style="width: 60%;">


<br>