# Parallel Register
---

## 이론

플립플롭을 데이터를 저장하는 용도로 많이 사용된다. 데이터는 숫자 값이나 2진으로 부호화된 여러 종류의 데이터를 말한다. 

이러한 데이터를 일반적으로 레지스터(register)라고 불리는 플립플롭 그룹에 저장되는데, 데이터를 이 레지스터에 저장하기 위하여 수행하는 동작을 데이터 전송(data transfer)라고 한다. 

<br>

다음 그림은 클럭의 입력을 갖는 D 플립플롭에서 데이터 전송이 어떻게 이루어지는지를 보여주고 있다. 

<img src="./pds/data01.png" alt="p02" style="width: 60%;"><br>
<br>

이전의 플립플롭 A에 저장되어 있는 논리 값이 클럭이 ‘0’에서 ‘1’로 변하는 순간(rising edge)에 플립플롭 B로 전송된다. 

이런 방법으로 클럭이 발생한 후에는 A의 출력과 B의 출력이 같아진다.

<br>

다음 그림은 레지스터에서 다른 레지스터로 데이터가 전송되는 것을 보여준다. 

<img src="./pds/data02.png" alt="p02" style="width: 60%;"><br>
<br>

레지스터 A는 A3, A2, A1, A0의 4개의 플립플롭으로 구성되어 있고, 레지스터 B는 B3, B2, B1, B0의 4개의 플립플롭으로 구성된다. 

클럭이 인가되면 클럭의 Rising Edge일 때, 레지스터 A에 저장되어 있는 A3, A2, A1, A0의 데이터는 레지스터 B의 각각 B3, B2, B1, B0으로 전송된다.

 이렇게 여러 개의 데이터가 동시에 전송되는 방식을 병렬 데이터 전송이라고 하며, 레지스터 A의 내용이 한번에 1비트씩 레지스터 B로 전송되는 방식을 직렬 데이터 전송이라고 한다. 
 
 <br>

병렬 전송은 송신 측의 레지스터 내용은 변하지 않는다는 것을 이해 하는 것이 중요하다. 

위의 그림에서 레지스터 B에 클럭이 인가되기 전의 내용이 레지스터 A = 1101, 레지스터 B = 1010이었다고 가정하면, 클럭이 인가된 후의 레지스터 내용은 A = 1101, B = 1101으로 두 레지스터의 값이 같아 지는 것을 확인할 수 있다. 

<br>



---
## **실습 목표 **

다음의 회로를 설계하여 실험해 보자.

<br>

<img src="./pds/pr03.png" alt="p03" style="width: 80%;">


<br>


<br>

SACT 장비에서 확인하기 위하여 연결된 장치는 다음과 같다. 

|D3|D2|D1|D0|CLK1|CLK2|
|:---:|:---:|:---:|:---:|:---:|:---:|
|S7|S6|S5|S4|SW7|SW6|

<br>

|A3|A2|A1|A0|B3|B2|B1|B0|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|LED7|LED6|LED5|LED4|LED3|LED2|LED1|LED0|

<br>
<img src="./pds/sact-pr.png" alt="sact-pr" style="width: 60%;">

<br>



### **설계**

1. 실험을 위해 프로젝트 파일 <a href="./pds/PR_4BIT.zip" download>PR_4BIT.zip</a>을 준비한다. 
<br>

2. 다운로드된 프로젝트의 압축 파일을 d:\work 이동시킨 후, 압축을 푼다.

3. Quartus II를 실행키고, File> Open Project 메뉴를 선택한다. 

<br>

4. 위에서 압축을 푼 위치인, d:\work\PR_4BIT 폴더로 이동 후,PR_4BIT 프로젝트를 OPEN한다. 

<br>

5. File > Open 메뉴를 선택하여 PR_4BIT.bdf 파일을 불러오거나, 프로젝트 왼쪽의 PR_4BIT 부분을 마우스로 더블 클릭한다. 

<br>

6. 아래 그림과 같이 미완성된 도면이 보이는데, 실습 목표에서 설명한 도면으로 완성시키자. 

<img src="./pds/pr05.png" alt="p05" style="width: 80%;"><br>

<img src="./pds/pr03.png" alt="p01" style="width: 80%;"><br>

7. dff 심볼을 불러오고, wire로 심볼을 연결시켜 회로를 완성시킨다.  

<img src="./pds/pr06.png" alt="p08" style="width: 80%;"><br>

<br>


### **컴파일**


8. File > Save 메뉴를 선택하여 저장하고, Processing > Start Compilation 메뉴를 선택하여 컴파일을 진행한다. 

이 컴파일 과정은 설계한 논리 회로에 오류가 없는 지를 검증하고, 프로그래밍 파일과 시뮬레이션 파일을 만드는 과정이다. 

<br><br>


### **시뮬레이션**

9. 컴파일 완료 후, File > Open 메뉴를 선택하고, 나타나는 Open File 창에서 오른쪽 아래 부분의 File Type을 All File(*.*)로 변경한 후, Waveform.vwf 파일을 선택한다. 

10. 아래 그림과 같이 Waveform 창에서, Simulation > Run Functiona Simulation 메뉴를 선택하여 Functional Simulation을 진행하여, 결과를 확인한다. 

<img src="./pds/ex10.png" alt="p11" style="width: 70%;"><br>

<img src="./pds/pr08.png" alt="p10" style="width: 100%;"><br>
<br>

### **하드웨어 동작 확인**

11. SACT 장비를 준비한다. USB 케이블과 파워 케이블을 연결하고, 전원 스위치를 눌러 장비에 전원을 인가시킨다. 

12. Quartus 소프트웨어에서 Tool > Programmer 메뉴를 선택한다.

13. Programmer창의 Hardware Setup이 USB Blaster가 연결되어 있는지 확인하고, Start 버튼을 눌러 프로그래밍 하고 장비에서 동작을 확인한다. 

<br>

14. 버튼 스위치와 슬라이드 스위치를 동작시키고, LED에서 결과를 확인해 보자. 

|D3|D2|D1|D0|CLK1|CLK2|
|:---:|:---:|:---:|:---:|:---:|:---:|
|S7|S6|S5|S4|SW7|SW6|

<br>

|A3|A2|A1|A0|B3|B2|B1|B0|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|LED7|LED6|LED5|LED4|LED3|LED2|LED1|LED0|

<br>
<img src="./pds/sact-pr.png" alt="sact-pr" style="width: 60%;">

<br>