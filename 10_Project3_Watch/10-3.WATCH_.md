# WATCH 3
---

## Clock with Minute/Second display

Let's make a clock using COUNTER and SEGMENT DISPLAY circuit practiced previously.


<br>

<img src="./pds/wta01.png" alt="scmp4_t-cmp4_" style="width: 60%;">

<br>

Let's create a clock that displays minute and second to operate faster on equipment. 

Clock design is divided into COUNTER block and SEGMENT DISPLAY block as shown below.

<img src="./pds/wt01.png" alt="scmp4_t-cmp4_" style="width: 80%;">
<BR><BR>



<BR>

Devices connected and pin numbers connected to check in SACT equipment are as below.

|PORT NAME|CLK|
|:-:|:-:|
|HARDWARE|Main Clock|
|PIN NUMBER|G2|

|PORT NAME|SEG_COM[7]|SEG_COM[6]|SEG_COM[5]|SEG_COM[4]|
|:-:|:-:|:-:|:-:|:-:|
|HARDWARE|SEG_COM[7]|SEG_COM[6]|SEG_COM[5]|SEG_COM[4]|
|PIN NUMBER|U1|T5|T4|T3|

|PORT NAME|SEG_COM[3]|SEG_COM[2]|SEG_COM[1]|SEG_COM[0]|
|:-:|:-:|:-:|:-:|:-:|
|HARDWARE|SEG_COM[3]|SEG_COM[2]|SEG_COM[1]|SEG_COM[0]|
|PIN NUMBER|R5|R4|R3|R2|

|PORT NAME|SEG_DATA[7]|SEG_DATA[6]|SEG_DATA[5]|SEG_DATA[4]|
|:-:|:-:|:-:|:-:|:-:|
|HARDWARE|SEG_A|SEG_B|SEG_C|SEG_D|
|PIN NUMBER|R1|P5|P4|R3|

|PORT NAME|SEG_DATA[3]|SEG_DATA[2]|SEG_DATA[1]|SEG_DATA[0]|
|:-:|:-:|:-:|:-:|:-:|
|HARDWARE|SEG_E|SEG_F|SEG_G|SEG_DP|
|PIN NUMBER|P2|P1|N6|N5|

<br>

<img src="./pds/wt02.png" alt="scmp4_t-cmp4_" style="width: 80%;">

<br><br>

### **Design**

1. Select File > New Project Wizard in Quartus to create new project.

2. Set Directory, Name, and Top-Level Entry window as below. 

    |Working Directory|d:\work\WATCH|
    |-|-|
    |project Name | WATCH|
    |Top Level Entry Name | WATCH|


3. Set Project Type to Empty project, and do not set Add File window.

4. In Family, Device&Board Setting window, first set Device Family/Package/Pin Count/Core speed grade as shown below, and then set Name.

    |Device Family|Cyclone 10 LP|
    |-|:-:|
    |Package|FBGA|
    |Pin count|484|
    |Core Speed grade|8|
    |Available devices|10CL080YF484C8G|

    <img src="./pds/cnt10_02.png" alt="traffic" style="width: 100%;"><br><br>

> Be careful that if device name changes, programming is not possible.

5. Do not set ‘EDA Tool Settings’.

    Check Summary to confirm the current settings and click Finish to complete project creation.

6. Copy SEG_DISP.bdf, CNT59.bdf file used in CNT59 and SEG_DISP project directory previously created to the current project directory WATCH.

>Copied files above are separately created circuits and they must be included in the project folder. If not, error message that there is no file when compiling will come out.

<br>

7. Import CNT59.bdf and SEG_DISP.bdf files through File > Open. Select File > Create / Update > Create Symbol Files for Current File and create a symbol file for the currently imported logic circuit.

8. Click File > New menu to open New window and select Block Diagram/Schematic File.

9. Right-click on the drawing and select Insert > Symbol menu (double-click on) the drawing, add symbol to complete the logic circuit as below.

    <img src="./pds/wt03a.png" alt="traffic" style="width: 100%;"><br><br>
    <img src="./pds/wt03b.png" alt="traffic" style="width: 100%;"><br><br>

    [Circuit using three 7490]
    
    - Circuit that connects three decimal counters using 7490s 
        
        If it receives CLK input and passes through 7490 circuit, it counts 10 times. The result is transmitted to clock input of the next7490 circuit.
        
        That is, when passing through one 7490 circuit, a clock reduced to 1/10 of the input clock is transmitted.
        
        Since three 7490 circuits are used, the clock reduced to 1/1000 is output.

        This block receives 1kHz CLOCK input and creates 1Hz clock (SEC_CLK).
    
    - Block receives CNT59 block and counts seconds of 059 and minutes of 059.

    - SEG_DISP block receives data from the block that counts second and minute of CNT59 and displays it on 7-Segment Array of the equipment.

        Clock input is the received CLK because faster clock is required to display characters on 7-segment array.

    <br>

10. Save. Set file name to project name (default setting).

### **Compile**

11. Select Processing > Start Compilation menu to proceed with compilation.

    This is the process of checking for errors in the design and synthesizing/ generating timing information / generating programming file.



### Device & Pin Assignment

12. Check the operation of the hardware through equipment.

    To check the equipment, set the pin for input/output port.

13. Select Assignment > Device.

    In the Device Settings window that appears, click ‘Device and Pin Options’ 

14. In ‘Device & Pin Option’ window, select “Unused Pins” category and set “Reserve all unused pins” to “As output driving ground”.
    
    It is because that default setting is “As input tri-stated with weak pull-up”, which causes the pins not set to be slightly pulled up, in High state.
    
    Since there are many elements such as LED configured in the equipment, if ‘As output driving ground’ is not set, unset LED may become ON causing output result confusing. Therefore, it is recommended to set Unused Pin as ‘As output driving ground’.


    <img src="./pds/cnt10_17.png" alt="traffic" style="width: 80%;"><br><br>
<br>

15. Select Assignment > Pin Planner to set PIN number.

16. Set PIN number in Location as shown in the table below.

    If PIN number is set differently, it will be difficult to check the operation of the device.

|PORT NAME|CLK|
|:-:|:-:|
|HARDWARE|Main Clock|
|PIN NUMBER|G2|

|PORT NAME|SEG_COM[7]|SEG_COM[6]|SEG_COM[5]|SEG_COM[4]|
|:-:|:-:|:-:|:-:|:-:|
|HARDWARE|SEG_COM[7]|SEG_COM[6]|SEG_COM[5]|SEG_COM[4]|
|PIN NUMBER|U1|T5|T4|T3|

|PORT NAME|SEG_COM[3]|SEG_COM[2]|SEG_COM[1]|SEG_COM[0]|
|:-:|:-:|:-:|:-:|:-:|
|HARDWARE|SEG_COM[3]|SEG_COM[2]|SEG_COM[1]|SEG_COM[0]|
|PIN NUMBER|R5|R4|R3|R2|

|PORT NAME|SEG_DATA[7]|SEG_DATA[6]|SEG_DATA[5]|SEG_DATA[4]|
|:-:|:-:|:-:|:-:|:-:|
|HARDWARE|SEG_A|SEG_B|SEG_C|SEG_D|
|PIN NUMBER|R1|P5|P4|R3|

|PORT NAME|SEG_DATA[3]|SEG_DATA[2]|SEG_DATA[1]|SEG_DATA[0]|
|:-:|:-:|:-:|:-:|:-:|
|HARDWARE|SEG_E|SEG_F|SEG_G|SEG_DP|
|PIN NUMBER|P2|P1|N6|N5|

<br>

<img src="./pds/wt02.png" alt="scmp4_t-cmp4_" style="width: 60%;">
<br>

17. After setting the pin, close the window and select Processing > Start Compilation menu to proceed with compilation. 

    This is to create a programming file that includes Device option and Pin configuration information.
<br><br>
    
### **Check Hardware Operation**

18. Prepare SACT equipment. Connect USB cable and power cable and press the power switch to supply power to the device.

19. In Quartus software, select Tool > Programmer.

20. Check that USB Blaster is connected in Hardware Setup on Programmer window. Press Start button to program to check the operation on the device.

21. Set to 1Hz using CLOCK SELECT SWITCH of CLOCK block and check the operation of the circuit by changing CLOCK.


<br>

<img src="./pds/wt02.png" alt="scmp4_t-cmp4_" style="width: 80%;">

<br>

## Application Design

22. Try to design a digital clock that displays hour, minute, second.











